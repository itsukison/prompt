(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))m(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&m(c)}).observe(document,{childList:!0,subtree:!0});function L(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function m(t){if(t.ep)return;t.ep=!0;const n=L(t);fetch(t.href,n)}})();const o=document.getElementById("prompt-input"),i=document.getElementById("generate-btn"),p=i.querySelector(".icon-send"),y=i.querySelector(".btn-loading"),l=document.getElementById("result-section"),v=document.getElementById("result-text"),B=document.getElementById("refine-btn"),S=document.getElementById("insert-btn"),h=document.getElementById("error-section"),b=document.getElementById("error-text"),I=document.getElementById("cancel-btn");document.querySelector(".input-bar");let s="",E=!1;function g(e){E=e,i.disabled=e,e?(p.style.display="none",y.classList.remove("hidden")):(p.style.display="block",y.classList.add("hidden"))}function d(e){b.textContent=e,h.classList.remove("hidden"),l.classList.add("hidden")}function u(){h.classList.add("hidden")}function O(e){s=e,v.textContent=e,l.classList.remove("hidden"),u()}function x(){l.classList.add("hidden"),s=""}async function w(){const e=o.value.trim();if(!(!e||E)){g(!0),u();try{const r=await window.promptOS.generate(e);r.success?O(r.text):d(r.error||"Failed to generate text")}catch(r){d(r.message||"An unexpected error occurred")}finally{g(!1)}}}async function k(){if(s)try{await window.promptOS.insert(s),a()}catch{d("Failed to insert text")}}function q(){o.focus(),o.select()}function a(){o.value="",x(),u()}function f(){window.promptOS.dismiss(),a()}i.addEventListener("click",w);o.addEventListener("keydown",e=>{e.key==="Enter"&&!e.shiftKey?(e.preventDefault(),w()):e.key==="Escape"&&f()});B.addEventListener("click",q);S.addEventListener("click",k);I.addEventListener("click",f);document.addEventListener("keydown",e=>{e.key==="Escape"&&f()});window.promptOS.onWindowShown(()=>{o.focus()});window.promptOS.onWindowHidden(()=>{a()});
